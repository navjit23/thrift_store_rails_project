
<h1>Your Order</h1>

<table>
  <thead>
    <tr>
      <th>Product</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Total Price</th>

    </tr>
  </thead>
  <tbody>
    <% total_price = 0 %>
    <% @cart_contents.each do |product_id, quantity| %>
      <% product = Product.find(product_id) %>
      <tr>
        <td><%= product.name %></td>
        <td><%= quantity %></td>
        <td><%= number_to_currency(product.price) %></td>
        <td><%= number_to_currency(product.price * quantity) %></td>
        <% total_price += (product.price * quantity) %>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="container">
<% if @address.present? %>

  GST: <%= number_to_currency(CartsController::GST * total_price /100 )%>
  <br>

    HST/PST: <%= number_to_currency(CartsController::State_tax[@province] *total_price / 100)%>

  <br>
  <br>
  Total: <%=  number_to_currency(total_price +CartsController::State_tax[@province] *total_price / 100 + CartsController::GST * total_price /100 ) %>
  </div>


  <div class="container">
  <h3>Shipping Address</h3>
  <p><strong>Address:</strong> <%= @address %></p>
  <p><strong>Postal Code:</strong> <%= @postal_code %></p>
  <p><strong>Province:</strong> <%= @province %></p>

  <%= form_tag place_order_path, method: :post do %>
  <%= submit_tag "Place Order" %>
<% end %>

  </div>
<% else%>
  <%= render "address_form" %>
<% end %>

